<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lake Tuz</title>

    <!-- Google Font: DM Serif Display -->
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&display=swap" rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'serif': ['DM Serif Display', 'serif'],
                    }
                }
            }
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/ScrollTrigger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/SplitText.min.js"></script>

</head>

<body class="h-screen text-white" style="background-color: color(display-p3 0.05 0.05 0.05);">
    <section class="screen1 h-screen relative flex justify-center items-center">
        <canvas class="glitch-canvas h-full w-auto filter saturate-200" width="512" height="512"></canvas>
        <div class="flex-grow flex flex-col justify-center items-center text-center p-4">
            <img src="tuz.svg" alt="Lake Tuz" class="mb-8 w-64 h-64" style="filter: brightness(0) invert(1);">
            <h1 class="text-8xl font-serif m-0" style="color: color(display-p3 1 1 1);">Lake Tuz</h1>
            <h2 class="text-2xl" style="color: color(display-p3 0.9 0.9 0.9);">a lake with thousand <span class="highlight">colors</span></h2>
        </div>
    </section>
    
    <section class="screen1-5 h-screen flex justify-center items-center p-4" style="background-color: color(display-p3 0.1 0.1 0.15);">
        <div class="text-center">
            <h2 class="text-8xl font-serif mb-8" style="color: color(display-p3 1 1 1);">Lake Tuz</h2>
            <p class="text-4xl leading-relaxed mx-32 my-16" style="color: color(display-p3 0.9 0.9 0.9);"><a href="https://en.wikipedia.org/wiki/Lake_Tuz" target="_blank" class="italic text-gray-300 hover:text-white transition-colors duration-200">Lake Tuz</a> is Turkey's second largest lake and one of the world's largest hypersaline lakes. Located in the Central Anatolia region, this remarkable body of water is famous for its dramatic color changes throughout the year, ranging from brilliant pink and salmon to crystal white, and sometimes even green and blue, depending on seasonal conditions and the presence of salt-tolerant microorganisms.</p>
        </div>
    </section>
    
    <section class="screen2 h-screen flex justify-center items-center p-4" style="background-color: rgb(70, 142, 144);">
        <div class="text-center">
            <p class="text-6xl text-white mx-32 my-16">The lake turns pink due to the presence of salt-tolerant algae like Dunaliella salina, which produces carotenoid pigments. These microorganisms thrive in the hypersaline conditions, creating the characteristic pink and salmon colors that make Lake Tuz so visually striking.</p>
        </div>
    </section>

    <section class="screen2-5 h-screen flex justify-center items-center p-4" style="background-color: rgb(70, 142, 144);">
        <div class="text-center">
            <p class="text-6xl text-white mx-32 my-16">During drought periods, the lake's water evaporates, leaving behind thick layers of salt crystals. The intense sunlight reflects off these white salt deposits, creating the lake's striking white appearance that contrasts dramatically with its colorful phases.</p>
        </div>
    </section>

    <section class="screen3 h-screen flex justify-center items-center p-4">
        <div class="text-center">
            <h2 class="text-4xl font-serif mb-6" style="color: color(display-p3 1 1 1);">Magical Colors of Lake Tuz</h2>
            <p class="text-lg mb-8" style="color: color(display-p3 0.8 0.8 0.8);"><a href="#" class="hover:text-blue-200 transition-colors duration-200 relative group" id="modis-link">Datasets from MODIS</a> instrument of the satellite Terra are used to find days with clear sky and to determine colors in the lake.</p>
            <div id="simple-graph"></div>
        </div>
    </section>

    <section class="screen-conditions h-screen flex justify-center items-center p-4" style="background-color: color(display-p3 0.15 0.1 0.1);">
        <div class="text-center max-w-6xl">
            <h2 class="text-6xl font-serif mb-8" style="color: color(display-p3 1 1 1);">Ideal Conditions for Color Transformation</h2>
            <div class="space-y-8 text-2xl leading-relaxed" style="color: color(display-p3 0.9 0.9 0.9);">
                <p class="mx-16">Lake Tuz's spectacular pink coloration occurs under specific environmental conditions that create the perfect habitat for salt-tolerant microorganisms like <em>Dunaliella salina</em> and halophilic bacteria.</p>
                <p class="mx-16">These microorganisms thrive when salinity levels reach 15-35% and water temperatures range between 20-35°C, conditions that typically occur during the hot, dry summer months when evaporation concentrates the salt content.</p>
                <p class="mx-16">During periods of heavy rainfall, the lake's salinity decreases significantly, and the characteristic blue color becomes more visible as the pink-pigmented microorganisms become less dominant in the diluted environment.</p>
            </div>
        </div>
    </section>

    <section class="screen4 h-screen flex justify-center items-center p-8 bg-white">
        <div class="text-center p-8">
            <img src="graph.png" alt="Lake Tuz Graph" class="mx-auto opacity-0" id="graph-image">
        </div>
    </section>

    <footer class="bg-gray-900 text-white py-8">
        <div class="max-w-6xl mx-auto px-4 text-center">
            <p class="text-lg mb-4">Made in two days for NASA Space Apps Challenge 2025</p>
            <p class="text-sm mb-6 text-gray-300">Team Members:</p>
            <div class="flex justify-center items-center space-x-8 mb-6">
                <div class="flex flex-col items-center">
                    <img src="safa_orhan.jpg" alt="Safa Orhan" class="w-20 h-20 rounded-full mb-2 object-cover">
                    <a href="https://x.com/safaorhanTR" target="_blank" class="text-blue-400 hover:text-blue-300 transition-colors duration-200">Safa Orhan</a>
                </div>
                <div class="flex flex-col items-center">
                    <img src="omer_faruk_oz.jpg" alt="Ömer Faruk Öz" class="w-20 h-20 rounded-full mb-2 object-cover">
                    <a href="https://www.linkedin.com/in/%C3%B6mer-faruk-%C3%B6z-3597191aa" target="_blank" class="text-blue-400 hover:text-blue-300 transition-colors duration-200">Ömer Faruk Öz</a>
                </div>
            </div>
            <p class="text-xs text-gray-400">© 2025 Lake Tuz Visualization Project</p>
        </div>
    </footer>

    <script>
        gsap.registerPlugin(ScrollTrigger, SplitText);

        function imageSequence(config) {
            let playhead = { frame: 0 },
                ctx = gsap.utils.toArray(config.canvas)[0].getContext("2d"),
                onUpdate = config.onUpdate,
                images,
                updateImage = function () {
                    ctx.drawImage(images[Math.round(playhead.frame)], 0, 0);
                    onUpdate && onUpdate.call(this);
                };
            images = config.urls.map((url, i) => {
                let img = new Image();
                img.src = url;
                i || (img.onload = updateImage);
                return img;
            });
            return gsap.to(playhead, {
                frame: images.length - 1,
                ease: "none",
                onUpdate: updateImage,
                scrollTrigger: config.scrollTrigger
            });
        }

        const urls = Array.from({ length: 52 }, (_, i) => `2020/${i + 1}.png`);

        imageSequence({
            urls, // Array of image URLs
            canvas: ".glitch-canvas", // <canvas> object to draw images to
            scrollTrigger: {
                trigger: ".screen1",
                start: "top top",
                end: "+=512",
                scrub: true, // important!
                markers: false,
                pin: true
            }
        });

        // SplitText animation for screen1-5
        const aboutText = new SplitText(".screen1-5 p", {type: "words"});
        
        gsap.fromTo(aboutText.words, 
            {
                opacity: 0,
                y: 30
            },
            {
                opacity: 1,
                y: 0,
                duration: 0.8,
                stagger: 0.05,
                ease: "power2.out",
                scrollTrigger: {
                    trigger: ".screen1-5",
                    start: "top center",
                    end: "50% center",
                    scrub: 1,
                    markers: false
                }
            }
        );

        // Color words based on their content
        aboutText.words.forEach(word => {
            const text = word.textContent.toLowerCase();
            if (text === "salmon") {
                word.style.color = "rgb(231, 155, 104)";
                word.style.fontWeight = "bold";
            } else if (text === "pink") {
                word.style.color = "rgb(238, 166, 138)";
                word.style.fontWeight = "bold";
            } else if (text === "white,") {
                word.style.color = "#ffffff";
                word.style.fontWeight = "bold";
            } else if (text === "green") {
                word.style.color = "rgb(70, 114, 60)";
                word.style.fontWeight = "bold";
            } else if (text === "blue,") {
                word.style.color = "rgb(70, 142, 144)";
                word.style.fontWeight = "bold";
            }
        });


        // Background color animation for screen2
        gsap.to(".screen2", {
            backgroundColor: "rgb(238, 166, 138)", // Realistic pink color
            scrollTrigger: {
                trigger: ".screen2",
                start: "top top",
                end: "bottom top",
                scrub: true,
                pin: true,
                markers: false
            }
        });

        // Background color animation for screen2-5 (teal to white)
        gsap.to(".screen2-5", {
            backgroundColor: "rgb(255, 255, 255)", // White color
            scrollTrigger: {
                trigger: ".screen2-5",
                start: "top top",
                end: "bottom top",
                scrub: true,
                pin: true,
                markers: false
            }
        });

        // Text color animation for screen2-5 (white to dark)
        gsap.to(".screen2-5 p", {
            color: "rgb(50, 50, 50)", // Dark gray color
            scrollTrigger: {
                trigger: ".screen2-5",
                start: "top top",
                end: "bottom top",
                scrub: true,
                markers: false
            }
        });

        // Simple multi-row graph with real data
        function createSimpleGraph() {
            const graph = document.getElementById('simple-graph');
            graph.innerHTML = '';
            
            const years = [2019, 2020, 2021, 2022, 2023, 2024, 2025];
            const months = ['JAN', 'FEB', 'MAR', 'APR', 'MAY', 'JUN', 'JUL', 'AUG', 'SEP', 'OCT', 'NOV', 'DEC'];
            
            // Create month header row
            const monthRow = document.createElement('div');
            monthRow.style.display = 'flex';
            monthRow.style.gap = '8px';
            monthRow.style.alignItems = 'center';
            monthRow.style.justifyContent = 'space-evenly';
            monthRow.style.marginBottom = '8px';
            
            // Add empty space for year labels
            const emptySpace = document.createElement('div');
            emptySpace.style.minWidth = '20px';
            monthRow.appendChild(emptySpace);
            
            // Add month labels (every 4 weeks)
            for (let i = 0; i < 12; i++) {
                const monthLabel = document.createElement('div');
                monthLabel.textContent = months[i];
                monthLabel.style.color = 'white';
                monthLabel.style.fontSize = '12px';
                monthLabel.style.fontWeight = 'bold';
                monthLabel.style.width = '48px'; // 4 weeks * 12px
                monthLabel.style.textAlign = 'center';
                monthRow.appendChild(monthLabel);
            }
            
            graph.appendChild(monthRow);
            
            // Load and use real data
            fetch('text.json')
                .then(response => response.json())
                .then(data => {
                    years.forEach(year => {
                        const row = document.createElement('div');
                        row.style.display = 'flex';
                        row.style.gap = '4px';
                        row.style.alignItems = 'center';
                        row.style.justifyContent = 'center';
                        row.style.marginBottom = '8px';
                        
                        // Add year label
                        const yearLabel = document.createElement('div');
                        yearLabel.textContent = year;
                        yearLabel.style.color = 'white';
                        yearLabel.style.fontSize = '12px';
                        yearLabel.style.fontWeight = 'bold';
                        yearLabel.style.minWidth = '40px';
                        row.appendChild(yearLabel);
                        
                        // Create 52 cells with real colors
                        for (let week = 0; week <= 51; week++) {
                            const cell = document.createElement('div');
                            cell.style.width = '20px';
                            cell.style.height = '20px';
                            cell.style.borderRadius = '4px';
                            
                            // Find data for this year and week
                            const weekData = data.find(item => item.year == year && item.week === week);
                            
                            if (weekData && weekData.color) {
                                // Use real color from the data
                                const { r, g, b } = weekData.color;
                                cell.style.backgroundColor = `rgb(${r}, ${g}, ${b})`;
                                
                                // Store the filename for tooltip use
                                cell.dataset.filename = weekData.date;
                            } else {
                                // Fallback to white if no data
                                cell.style.backgroundColor = 'white';
                                cell.dataset.filename = 'examples/1.png'; // Default fallback
                            }
                            
                            // Set initial state for animation
                            cell.style.opacity = '0';
                            cell.style.scale = '0.5';
                            
                            // Add tooltip functionality
                            cell.addEventListener('mouseenter', function(e) {
                                // Get or create tooltip
                                let tooltip = document.querySelector('.cell-tooltip');
                                
                                if (!tooltip) {
                                    // Create tooltip if it doesn't exist
                                    tooltip = document.createElement('div');
                                    tooltip.className = 'cell-tooltip';
                                    tooltip.style.cssText = `
                                        position: fixed;
                                        top: ${e.clientY + 10}px;
                                        left: ${e.clientX + 10}px;
                                        z-index: 1000;
                                        pointer-events: none;
                                        background: rgba(0, 0, 0, 0.8);
                                        padding: 20px;
                                        border-radius: 4px;
                                        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
                                    `;
                                    document.body.appendChild(tooltip);
                                } else {
                                    // Update position if tooltip exists
                                    tooltip.style.top = `${e.clientY + 10}px`;
                                    tooltip.style.left = `${e.clientX + 10}px`;
                                }
                                
                                // Update image source
                                const img = tooltip.querySelector('img') || document.createElement('img');
                                img.src = `selected/${cell.dataset.filename}` || 'examples/1.png';
                                img.style.cssText = `
                                    width: 250px;
                                    height: 250px;
                                    object-fit: cover;
                                    border-radius: 4px;
                                    filter: saturate(2);
                                `;
                                
                                // Add image to tooltip if not already there
                                if (!tooltip.querySelector('img')) {
                                    tooltip.appendChild(img);
                                }
                                
                                // Add date text below image
                                const dateText = tooltip.querySelector('.date-text') || document.createElement('div');
                                dateText.className = 'date-text';
                                dateText.textContent = cell.dataset.filename ? cell.dataset.filename.replace('.png', '') : 'Unknown Date';
                                dateText.style.cssText = `
                                    color: white;
                                    font-size: 14px;
                                    text-align: center;
                                    margin-top: 10px;
                                    font-weight: 500;
                                `;
                                
                                if (!tooltip.querySelector('.date-text')) {
                                    tooltip.appendChild(dateText);
                                }
                            });
                            
                            // Update tooltip position on mousemove
                            cell.addEventListener('mousemove', function(e) {
                                const tooltip = document.querySelector('.cell-tooltip');
                                if (tooltip) {
                                    tooltip.style.top = `${e.clientY + 10}px`;
                                    tooltip.style.left = `${e.clientX + 10}px`;
                                }
                            });
                            
                            // Add mouseleave event listener to the graph container
                            const graph = document.getElementById('simple-graph');
                            graph.addEventListener('mouseleave', function() {
                                const tooltip = document.querySelector('.cell-tooltip');
                                if (tooltip) {
                                    tooltip.remove();
                                }
                            });
                            
                            row.appendChild(cell);
                        }
                        
                        graph.appendChild(row);
                    });
                    
                    // Animate all cells with GSAP and ScrollTrigger
                    const allCells = graph.querySelectorAll('div[style*="width: 20px"]');
                    gsap.fromTo(allCells, 
                        {
                            opacity: 0,
                            scale: 0.5
                        },
                        {
                            opacity: 1,
                            scale: 1,
                            duration: 0.6,
                            stagger: 0.02,
                            ease: "back.out(1.7)",
                            scrollTrigger: {
                                trigger: graph,
                                start: "top bottom",
                                end: "center center",
                                scrub: 1,
                                toggleActions: "play none none reverse",
                                markers: false
                            }
                        }
                    );
                })
                .catch(error => {
                    console.error('Error loading data:', error);
                    // Fallback to random colors if data fails to load
                    years.forEach(year => {
                        const row = document.createElement('div');
                        row.style.display = 'flex';
                        row.style.gap = '4px';
                        row.style.alignItems = 'center';
                        row.style.justifyContent = 'center';
                        row.style.marginBottom = '8px';
                        
                        const yearLabel = document.createElement('div');
                        yearLabel.textContent = year;
                        yearLabel.style.color = 'white';
                        yearLabel.style.fontSize = '12px';
                        yearLabel.style.fontWeight = 'bold';
                        yearLabel.style.minWidth = '40px';
                        row.appendChild(yearLabel);
                        
                        for (let i = 0; i < 52; i++) {
                            const cell = document.createElement('div');
                            cell.style.width = '12px';
                            cell.style.height = '12px';
                            cell.style.borderRadius = '2px';
                            cell.style.backgroundColor = 'white';
                            row.appendChild(cell);
                        }
                        
                        graph.appendChild(row);
                    });
                });
        }
        
        document.addEventListener('DOMContentLoaded', createSimpleGraph);

        // Graph fade-in animation with scrub
        gsap.fromTo("#graph-image", 
            {
                opacity: 0,
                y: 50
            },
            {
                opacity: 1,
                y: 0,
                duration: 1,
                scrollTrigger: {
                    trigger: ".screen4",
                    start: "top center",
                    end: "center center",
                    scrub: 1,
                    toggleActions: "play none none reverse"
                }
            }
        );

        // MODIS tooltip functionality
        const modisLink = document.getElementById('modis-link');
        let modisTooltip = null;

        modisLink.addEventListener('mouseenter', function(e) {
            // Create tooltip if it doesn't exist
            if (!modisTooltip) {
                modisTooltip = document.createElement('div');
                modisTooltip.className = 'modis-tooltip';
                modisTooltip.style.cssText = `
                    position: fixed;
                    top: ${e.clientY + 10}px;
                    left: ${e.clientX + 10}px;
                    z-index: 1000;
                    pointer-events: none;
                    background: rgba(0, 0, 0, 0.9);
                    color: white;
                    padding: 12px 16px;
                    border-radius: 8px;
                    font-size: 14px;
                    line-height: 1.4;
                    max-width: 300px;
                    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
                    opacity: 0;
                    transition: opacity 0.2s ease;
                `;
                modisTooltip.innerHTML = `
                    <div style="font-weight: bold; margin-bottom: 8px;">MODIS Datasets:</div>
                    <div>• Corrected Reflectance (True Color), Terra / MODIS</div>
                    <div>• Cloud Multi Layer Flag, Terra / MODIS</div>
                `;
                document.body.appendChild(modisTooltip);
            } else {
                // Update position if tooltip exists
                modisTooltip.style.top = `${e.clientY + 10}px`;
                modisTooltip.style.left = `${e.clientX + 10}px`;
            }
            
            // Show tooltip with fade-in
            setTimeout(() => {
                if (modisTooltip) {
                    modisTooltip.style.opacity = '1';
                }
            }, 10);
        });

        modisLink.addEventListener('mousemove', function(e) {
            if (modisTooltip) {
                modisTooltip.style.top = `${e.clientY + 10}px`;
                modisTooltip.style.left = `${e.clientX + 10}px`;
            }
        });

        modisLink.addEventListener('mouseleave', function() {
            if (modisTooltip) {
                modisTooltip.style.opacity = '0';
                setTimeout(() => {
                    if (modisTooltip) {
                        modisTooltip.remove();
                        modisTooltip = null;
                    }
                }, 200);
            }
        });

        // Graph image tooltip functionality
        const graphImage = document.getElementById('graph-image');
        let graphTooltip = null;

        graphImage.addEventListener('mouseenter', function(e) {
            // Create tooltip if it doesn't exist
            if (!graphTooltip) {
                graphTooltip = document.createElement('div');
                graphTooltip.className = 'graph-tooltip';
                graphTooltip.style.cssText = `
                    position: fixed;
                    top: ${e.clientY + 10}px;
                    left: ${e.clientX + 10}px;
                    z-index: 1000;
                    pointer-events: none;
                    background: rgba(0, 0, 0, 0.9);
                    color: white;
                    padding: 12px 16px;
                    border-radius: 8px;
                    font-size: 14px;
                    line-height: 1.4;
                    max-width: 300px;
                    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
                    opacity: 0;
                    transition: opacity 0.2s ease;
                `;
                graphTooltip.innerHTML = `
                    <div style="font-weight: bold; margin-bottom: 8px;">Dataset Information:</div>
                    <div>• Land Surface Temperature (Day), Terra / MODIS</div>
                `;
                document.body.appendChild(graphTooltip);
            } else {
                // Update position if tooltip exists
                graphTooltip.style.top = `${e.clientY + 10}px`;
                graphTooltip.style.left = `${e.clientX + 10}px`;
            }
            
            // Show tooltip with fade-in
            setTimeout(() => {
                if (graphTooltip) {
                    graphTooltip.style.opacity = '1';
                }
            }, 10);
        });

        graphImage.addEventListener('mousemove', function(e) {
            if (graphTooltip) {
                graphTooltip.style.top = `${e.clientY + 10}px`;
                graphTooltip.style.left = `${e.clientX + 10}px`;
            }
        });

        graphImage.addEventListener('mouseleave', function() {
            if (graphTooltip) {
                graphTooltip.style.opacity = '0';
                setTimeout(() => {
                    if (graphTooltip) {
                        graphTooltip.remove();
                        graphTooltip = null;
                    }
                }, 200);
            }
        });

    </script>
</body>

</html>